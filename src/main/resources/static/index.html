<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Receipt Master | ë©”ì¸</title>
    <style>
        :root { --kakao-color: #FEE500; --google-color: #4285F4; --main-color: #4CAF50; }
        body { font-family: sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; background-color: #f4f7f6; }
        .container { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; max-width: 400px; width: 90%; }
        .btn { display: block; padding: 12px; margin: 10px 0; border-radius: 8px; text-decoration: none; font-weight: bold; transition: 0.3s; border: none; font-size: 0.95rem; cursor: pointer; }
        .btn-google { background: var(--google-color); color: white; }
        .btn-kakao { background: var(--kakao-color); color: #3c1e1e; }
        .btn-signin { background: var(--main-color); color: white; }
        .btn-signup { border: 1px solid var(--main-color); color: var(--main-color); background: white; }
        .hidden { display: none; }
        .divider { margin: 20px 0; display: flex; align-items: center; color: #ccc; font-size: 0.8rem; }
        .divider::before, .divider::after { content: ""; flex: 1; height: 1px; background: #eee; margin: 0 10px; }
        #loading-section { color: #666; font-style: italic; }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ§¾ Receipt Master</h1>

    <div id="intro-section">
        <p><strong>ì˜ìˆ˜ì¦ ê´€ë¦¬ì˜ ì‹œì‘</strong></p>
        <p style="font-size: 0.85rem; color: #888; margin-bottom: 25px;">ê°„í¸í•˜ê²Œ ì‹œì‘í•˜ì„¸ìš”.</p>

        <a href="/oauth2/authorization/google" class="btn btn-google">Googleë¡œ ì‹œì‘í•˜ê¸°</a>
        <a href="/oauth2/authorization/kakao" class="btn btn-kakao">Kakaoë¡œ ì‹œì‘í•˜ê¸°</a>

        <div class="divider">ë˜ëŠ”</div>

        <a href="/signin.html" class="btn btn-signin">ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸</a>
        <a href="/signup.html" class="btn btn-signup">ìƒˆë¡œ ê°€ì…í•˜ê¸°</a>
    </div>

    <div id="loading-section" class="hidden">
        <p>ğŸ” ì›Œí¬ìŠ¤í˜ì´ìŠ¤ í™•ì¸ ì¤‘...</p>
        <p style="font-size: 0.8rem; color: #999; margin-top: 10px;">ë¡œê·¸ì¸ ìƒíƒœê°€ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
        <button onclick="logout()" style="margin-top: 20px; border: none; background: none; color: #cc0000; cursor: pointer; text-decoration: underline;">ë¡œê·¸ì•„ì›ƒ í…ŒìŠ¤íŠ¸</button>
    </div>
</div>

<script>
    function logout() {
        localStorage.clear();
        location.href = "/";
    }

    window.onload = () => {
        // 1. URL ì£¼ì†Œì°½ì—ì„œ í† í° ì¶”ì¶œ (ì†Œì…œ ë¡œê·¸ì¸ìš©)
        const urlParams = new URLSearchParams(window.location.search);
        const tokenFromUrl = urlParams.get('token');

        if (tokenFromUrl) {
            localStorage.setItem('accessToken', tokenFromUrl);
            window.history.replaceState({}, document.title, "/");
        }

        // 2. í† í° í™•ì¸
        const token = localStorage.getItem('accessToken');

        if (token) {
            // 3. ë¡œê·¸ì¸ ìƒíƒœë©´ UI ì „í™˜ í›„ ê·¸ëŒ€ë¡œ ë©ˆì¶¤
            document.getElementById('intro-section').classList.add('hidden');
            document.getElementById('loading-section').classList.remove('hidden');

            console.log("ë¡œê·¸ì¸ ì„±ê³µ! í† í° ë³´ê´€ ì¤‘:", token);
        }
    };
</script>
</body>
</html>